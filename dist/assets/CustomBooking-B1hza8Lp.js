import{r as n,j as e,L as x,y as o}from"./index-CkFDTInH.js";import{a as i}from"./api-DZWw9RV8.js";import{M as p}from"./index-BM2X0C-P.js";import{H as u}from"./Helmet-QCzmYxYa.js";function y(){const[l,a]=n.useState(!1),[c,d]=n.useState([]);async function m(){try{a(!0);const s=localStorage.getItem("userToken");if(!s)throw new Error("User token not found. Please log in.");const{data:t}=await i.get("/api/v1/customebookings/my-custome-bookings",{headers:{Authorization:`Bearer ${s}`}});d(t.data.customeBookings),a(!1)}catch(s){a(!1),o.error(s.message||"Failed to fetch bookings")}}async function h(s){try{const t=localStorage.getItem("userToken"),{data:r}=await i.get(`/api/v1/bookings/checkout-session-custome/${s}`,{headers:{Authorization:`Bearer ${t}`}});r.session&&r.session.url?window.location.href=r.session.url:o.error("Failed to initiate checkout session.")}catch{o.error("Something went wrong during checkout.")}}return n.useEffect(()=>{m()},[]),e.jsxs(e.Fragment,{children:[e.jsx(u,{children:e.jsx("title",{children:"Your Custom Bookings"})}),e.jsx("section",{className:"custom-bookings my-5 py-5",children:e.jsxs("div",{className:"container mt-5 pt-3",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("h3",{className:"text-center mb-4",children:"Your Custom Bookings"}),e.jsx("div",{children:e.jsx(x,{to:"/paid-booking",className:"btn btn-danger",children:"Show Paid Booking"})})]}),l?e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"spinner-border text-danger",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):!c||c.length===0?e.jsx("p",{className:"text-center text-muted",children:"No bookings found"}):e.jsx("div",{className:"row",children:c.map(s=>e.jsx("div",{className:"col-md-4 mb-4",children:e.jsxs("div",{className:"card h-100",children:[e.jsx("img",{src:s.space?`http://localhost:3000/img/spaces/${s.space.imageCover}`:"https://placehold.co/600x400",className:"card-img-top",alt:s.space?s.space.name:"No space available",style:{height:"200px",objectFit:"cover"}}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center mb-4 main-color",children:s.space?s.space.name:"No space available"}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{children:"Date:"})," ",new Date(s.date).toLocaleDateString()]}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{children:"Created At:"})," ",new Date(s.createdAt).toLocaleDateString()]}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{children:"Technology:"})," ",s.technology.map(t=>t.name).join(", ")]}),s.price&&e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{children:"ðŸ’° Price:"})," $",s.price]}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{children:"Status:"})," ",s.paid?e.jsx("span",{className:"text-success",children:"âœ… Paid"}):e.jsx("span",{className:"text-danger",children:"ðŸ’³ Pending Payment"})]}),!s.paid&&e.jsxs("button",{className:"btn btn-danger w-100",onClick:()=>h(s._id),children:["Pay Now ",e.jsx(p,{})]})]})]})},s._id))})]})})]})}export{y as default};
