import{r as t,j as e,R as C,y as l}from"./index-DoYqLEuC.js";import{a as o}from"./api-BDs2Ot40.js";import{F as E}from"./index-D7reRtq0.js";import{H as F}from"./Helmet-lAKtP1rb.js";function I(){const[r,c]=t.useState([]),[N,i]=t.useState(!1),[f,n]=t.useState(!1),[m,v]=t.useState(null),[h,x]=t.useState(""),[u,p]=t.useState(""),[j,b]=t.useState("");async function y(){try{i(!0);const s=localStorage.getItem("adminToken"),{data:a}=await o.get("/api/v1/users",{headers:{Authorization:`Bearer ${s}`}});c(a.data.user),l.success("Users fetched successfully!"),i(!1)}catch{i(!1),l.error("Failed to fetch users")}}function U(s){localStorage.setItem("selectedUserId",s)}async function g(s){try{const a=localStorage.getItem("adminToken");await o.delete(`/api/v1/users/${s}`,{headers:{Authorization:`Bearer ${a}`}}),c(r.filter(d=>d._id!==s)),l.success("User deleted successfully")}catch{l.error("Failed to delete user")}}async function k(){try{const s=localStorage.getItem("adminToken"),a={name:h,email:u,role:j};await o.patch(`/api/v1/users/${m._id}`,a,{headers:{Authorization:`Bearer ${s}`}}),c(r.map(d=>d._id===m._id?{...d,...a}:d)),n(!1),l.success("User updated successfully")}catch{l.error("Failed to update user")}}t.useEffect(()=>{y()},[]);const S=s=>{v(s),x(s.name),p(s.email),b(s.role),n(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(F,{children:e.jsx("title",{children:"Users"})}),e.jsx("section",{className:"users my-5 py-5",children:e.jsxs("div",{className:"container mt-5 pt-3",children:[e.jsx("h3",{className:"text-center mb-4",children:"All Users"}),N?e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"spinner-border text-danger",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):r.length>0?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered table-striped table-sm text-center align-middle w-100",children:[e.jsx("thead",{className:"table-dark",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"Name"}),e.jsx("th",{scope:"col",children:"Email"}),e.jsx("th",{scope:"col",children:"Role"}),e.jsx("th",{scope:"col",children:"Actions"})]})}),e.jsx("tbody",{children:r.map((s,a)=>e.jsxs("tr",{onClick:()=>U(s._id),children:[e.jsx("td",{children:a+1}),e.jsx("td",{className:"text-break",children:s.name}),e.jsx("td",{className:"text-break",children:s.email}),e.jsx("td",{children:s.role}),e.jsxs("td",{children:[e.jsxs("button",{className:"btn btn-sm btn-outline-primary me-2 mb-1",onClick:()=>S(s),children:["Update ",e.jsx(E,{})]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger mb-1",onClick:()=>g(s._id),children:["Delete ",e.jsx(C,{})]})]})]},s._id))})]})}):e.jsx("p",{className:"text-center",children:"No users found."})]})}),f&&e.jsx("div",{className:"modal fade show",tabIndex:"-1","aria-labelledby":"updateUserModalLabel","aria-hidden":"true",style:{display:"block"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"updateUserModalLabel",children:"Update User"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:()=>n(!1)})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"name",className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",id:"name",value:h,onChange:s=>x(s.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"email",className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",id:"email",value:u,onChange:s=>p(s.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"role",className:"form-label",children:"Role"}),e.jsxs("select",{className:"form-select",id:"role",value:j,onChange:s=>b(s.target.value),children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:()=>n(!1),children:"Close"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:k,children:"Update"})]})]})})})]})}export{I as default};
