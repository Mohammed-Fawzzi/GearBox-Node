import{r as s,j as e,R as k,y as t}from"./index-DoYqLEuC.js";import{a as o}from"./api-BDs2Ot40.js";import{F as z}from"./index-D7reRtq0.js";import{H as D}from"./Helmet-lAKtP1rb.js";function E(){const[n,c]=s.useState([]),[y,r]=s.useState(!1),[S,d]=s.useState(!1),[m,C]=s.useState(null),[u,h]=s.useState(""),[p,x]=s.useState(""),[b,j]=s.useState(""),[g,v]=s.useState(!1),[N,f]=s.useState(0);async function w(){try{r(!0);const{data:a}=await o.get("/api/v1/spaces");c(a.data.spaces),r(!1),t.success("Spaces fetched successfully!")}catch{r(!1),t.error("Failed to fetch spaces")}}async function F(a){try{const l=localStorage.getItem("adminToken");await o.delete(`/api/v1/spaces/${a}`,{headers:{Authorization:`Bearer ${l}`}}),c(n.filter(i=>i._id!==a)),t.success("Space deleted successfully")}catch{t.error("Failed to delete space")}}async function A(){try{const a=localStorage.getItem("adminToken"),l={name:u,description:p,size:b,available:g,ratingsAverage:N};await o.patch(`/api/v1/spaces/${m._id}`,l,{headers:{Authorization:`Bearer ${a}`}}),c(n.map(i=>i._id===m._id?{...i,...l}:i)),d(!1),t.success("Space updated successfully")}catch{t.error("Failed to update space")}}const U=a=>{C(a),h(a.name),x(a.description),j(a.size),v(a.available),f(a.ratingsAverage),d(!0)};return s.useEffect(()=>{w()},[]),e.jsxs(e.Fragment,{children:[e.jsx(D,{children:e.jsx("title",{children:"Spaces Operations"})}),e.jsxs("section",{className:"spaces my-5 py-5",children:[e.jsxs("div",{className:"container mt-5 pt-3",children:[e.jsx("h3",{className:"text-center mb-4",children:"Spaces"}),y?e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"spinner-border text-danger",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):n.length===0?e.jsx("p",{className:"text-center text-muted",children:"No spaces found"}):e.jsx("div",{className:"row g-4",children:n.map(a=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"space-card p-4 bg-white shadow-sm rounded",children:[e.jsx("div",{className:"text-center mb-3",children:e.jsx("img",{src:a.imageCover&&a.imageCover!=="undefined"?`http://localhost:3000/img/spaces/${a.imageCover}`:"https://placehold.co/600x400",alt:a.name,className:"img-fluid rounded",style:{height:"200px",objectFit:"cover"}})}),e.jsxs("h5",{className:"fw-semibold text-danger text-center pb-2",children:["[ ",a.name," ]"]}),e.jsxs("p",{className:"mb-4 text-muted",children:[e.jsx("strong",{children:"📝 Description:"})," ",a.description]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("span",{className:"badge bg-secondary rounded-0 p-2",children:["📐 ",a.size]}),e.jsx("span",{className:`badge rounded-0 p-2 ${a.available?"bg-success":"bg-danger"}`,children:a.available?"✅ Available":"❌ Unavailable"})]}),e.jsxs("p",{className:"text-muted pb-2 mt-auto",children:[e.jsx("strong",{children:"⭐ Rating:"})," ",a.ratingsAverage," (",a.ratingsQuantity,")"]}),e.jsxs("div",{className:"d-flex justify-content-between pt-3 border-top border-danger",children:[e.jsxs("button",{className:"btn btn-primary rounded-0",onClick:()=>U(a),children:["Update ",e.jsx(z,{})]}),e.jsxs("button",{className:"btn btn-danger rounded-0",onClick:()=>F(a._id),children:["Delete ",e.jsx(k,{})]})]})]})},a._id))})]}),S&&e.jsx("div",{className:"modal fade show",tabIndex:"-1","aria-labelledby":"updateSpaceModalLabel","aria-hidden":"true",style:{display:"block"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"updateSpaceModalLabel",children:"Update Space"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:()=>d(!1)})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"name",className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",id:"name",value:u,onChange:a=>h(a.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-control",id:"description",value:p,onChange:a=>x(a.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"size",className:"form-label",children:"Size (sqm)"}),e.jsx("input",{type:"text",className:"form-control",id:"size",value:b,onChange:a=>j(a.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"available",className:"form-label",children:"Available"}),e.jsxs("select",{className:"form-select",id:"available",value:g,onChange:a=>v(a.target.value==="true"),children:[e.jsx("option",{value:"true",children:"Available"}),e.jsx("option",{value:"false",children:"Unavailable"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"rating",className:"form-label",children:"Rating"}),e.jsx("input",{type:"number",className:"form-control",id:"rating",value:N,onChange:a=>f(a.target.value)})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:()=>d(!1),children:"Close"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:A,children:"Update"})]})]})})})]})]})}export{E as default};
