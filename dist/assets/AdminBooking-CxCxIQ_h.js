import{r as d,j as e,R as w,y as o}from"./index-DUA-Fp3y.js";import{a as c}from"./api-CbkES3Ey.js";import{F as C}from"./index-CYzxEoUc.js";import{H as L}from"./Helmet-Cev6nNvG.js";function $(){const[f,i]=d.useState(!0),[l,r]=d.useState([]),[v,n]=d.useState(!1),[m,N]=d.useState(null),[h,p]=d.useState("");async function k(){try{const a=localStorage.getItem("adminToken");i(!0);let{data:s}=await c.get("/api/v1/bookings",{headers:{Authorization:`Bearer ${a}`}});o.success("Booking data fetched successfully"),r(s.data.bookings),i(!1)}catch{i(!1),o.error("Failed to fetch Booking data")}finally{i(!1)}}async function D(a){try{const s=localStorage.getItem("adminToken");await c.delete(`/api/v1/bookings/${a}`,{headers:{Authorization:`Bearer ${s}`}}),r(l.filter(t=>t._id!==a)),o.success("Booking deleted successfully")}catch{o.error("Failed to delete Booking")}}async function B(){try{const a=localStorage.getItem("adminToken"),s={deliveryDate:h};await c.patch(`/api/v1/bookings/${m._id}`,s,{headers:{Authorization:`Bearer ${a}`}}),r(l.map(t=>t._id===m._id?{...t,...s}:t)),n(!1),o.success("Booking updated successfully")}catch{o.error("Failed to update booking")}}const S=a=>{N(a),p(new Date(a.deliveryDate).toISOString().slice(0,10)),n(!0)};return d.useEffect(()=>{k()},[]),e.jsxs(e.Fragment,{children:[e.jsx(L,{children:e.jsx("title",{children:"Booking"})}),e.jsx("section",{className:"admin-booking my-5 py-5",children:e.jsx("div",{className:"container mt-5 pt-3",children:f?e.jsx("div",{children:"Loading..."}):e.jsx("div",{className:"row",children:l.length>0?l.map(a=>{var s,t,x,u,g,j,b;return e.jsx("div",{className:"col-md-4 mb-4",children:e.jsxs("div",{className:"card border border-danger",children:[((s=a.booking)==null?void 0:s.space)&&e.jsx("img",{src:a.booking.space.imageCover?`http://localhost:3000/img/spaces/${a.booking.space.imageCover}`:"https://placehold.co/600x400",alt:a.booking.space.name,className:"card-img-top border-bottom border-danger"}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:(t=a.booking)!=null&&t.space?a.booking.space.name:(x=a.booking)==null?void 0:x.name}),e.jsxs("p",{className:"card-text",children:["Price: ",a.price," 💸"]}),e.jsx("p",{className:"card-text",children:a.paid?"Paid ✅":"Not Paid ❌"}),e.jsxs("p",{className:"card-text",children:["Booking created at:"," ",new Date(a.createdAt).toLocaleDateString()]}),e.jsxs("p",{className:"card-text",children:["Delivered Date:"," ",a.deliveryDate?new Date(a.deliveryDate).toLocaleDateString():"Not specified"]}),((g=(u=a.booking)==null?void 0:u.technology)==null?void 0:g.length)>0&&e.jsxs("div",{children:[e.jsx("h6",{children:"Technologies 🛠️:"}),a.booking.technology.map(y=>e.jsx("div",{children:e.jsx("p",{children:y.name})},y._id))]}),!((j=a.booking)!=null&&j.space)&&((b=a.booking)==null?void 0:b.name)&&e.jsxs("div",{children:[e.jsx("h6",{children:"Package Name 📦:"}),e.jsx("p",{children:a.booking.name})]}),e.jsxs("div",{className:"d-flex justify-content-between pt-3 border-top border-danger",children:[e.jsxs("button",{className:"btn btn-primary rounded-0",onClick:()=>S(a),children:["Update ",e.jsx(C,{})]}),e.jsxs("button",{className:"btn btn-danger rounded-0",onClick:()=>D(a._id),children:["Delete ",e.jsx(w,{})]})]})]})]})},a._id)}):e.jsx("p",{children:"No bookings found"})})})}),v&&e.jsx("div",{className:"modal fade show",tabIndex:"-1","aria-labelledby":"updateBookingModalLabel","aria-hidden":"true",style:{display:"block"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"updateBookingModalLabel",children:"Update Booking"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:()=>n(!1)})]}),e.jsx("div",{className:"modal-body",children:e.jsx("form",{children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"deliveryDate",className:"form-label",children:"Delivery Date"}),e.jsx("input",{type:"date",className:"form-control",id:"deliveryDate",value:h,onChange:a=>p(a.target.value)})]})})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:()=>n(!1),children:"Close"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:B,children:"Update"})]})]})})})]})}export{$ as default};
