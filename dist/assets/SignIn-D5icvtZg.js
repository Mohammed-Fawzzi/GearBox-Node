import{a as p,r as o,e as g,j as e,L as n,y as i}from"./index-CkFDTInH.js";import{u as x}from"./formik.esm-DURCDBCU.js";import{c as f,a as d}from"./index.esm-DHsu0I8t.js";import{a as j}from"./api-DZWw9RV8.js";function y(){const t=p(),{setIsUserLogin:c}=o.useContext(g),[l,r]=o.useState(!1);async function m(h){try{r(!0);let{data:s}=await j.post("/api/v1/users/login",h);localStorage.setItem("role",s.data.user.role),c(s.status),i.success("You have successfully logged in"),s.data.user.role==="admin"?(localStorage.setItem("adminToken",s.token),t("/admin-dashboard",{replace:!0})):(localStorage.setItem("userToken",s.token),localStorage.setItem("userName",s.data.user.name),localStorage.setItem("userEmail",s.data.user.email),t("/",{replace:!0})),r(!1)}catch{r(!1),i.error("Login failed, please try again!")}}const u=f({email:d().email().required("Email is required"),password:d().matches(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/,"Password must be at least 8 characters long, contain at least one letter, one number and one special character.").required("Password is required")});let a=x({initialValues:{email:"",password:""},validationSchema:u,onSubmit:m});return e.jsx("section",{className:"sign-in my-5 py-5",children:e.jsx("div",{className:"container mt-5 pt-5",children:e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-md-8",children:e.jsxs("form",{className:"p-4",onSubmit:a.handleSubmit,children:[e.jsx("h3",{className:"text-center mb-4",children:"Login"}),e.jsxs("div",{className:"form-floating mb-3",children:[e.jsx("input",{type:"email",id:"email",placeholder:"Enter your email",className:"form-control",value:a.values.email,onChange:a.handleChange,onBlur:a.handleBlur}),e.jsx("label",{htmlFor:"email",children:"Email"}),a.errors.email&&a.touched.email?e.jsx("div",{className:"alert alert-danger p-2 my-2 rounded-0",children:a.errors.email}):""]}),e.jsxs("div",{className:"form-floating mb-3",children:[e.jsx("input",{type:"password",id:"password",placeholder:"Enter your password",className:"form-control",value:a.values.password,onChange:a.handleChange,onBlur:a.handleBlur}),e.jsx("label",{htmlFor:"password",children:"Password"}),a.errors.password&&a.touched.password?e.jsx("div",{className:"alert alert-danger p-2 my-2 rounded-0",children:a.errors.password}):""]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{children:"Don't have an account? "}),e.jsx(n,{to:"/sign-up",className:"main-color",children:"Sign Up"})]}),e.jsx("div",{className:"mb-3",children:e.jsx(n,{to:"/forget-password",className:"main-color",children:"Forget your password?"})})]}),e.jsx("button",{type:"submit",className:"btn btn-danger rounded-0 text-center mx-auto w-100",disabled:l||!(a.isValid&&a.dirty),children:l?"Loading...":"Login"})]})})})})})}export{y as default};
